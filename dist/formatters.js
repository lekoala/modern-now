function $(t,e=null,n=document){return Array.from(n.querySelectorAll(t))}function U(t){return t.replace(/([A-Z])/g,"-$1").toLowerCase()}function V(t){return t.charAt(0).toLocaleUpperCase()+t.slice(1)}function z(t){return["true","1"].includes(String(t).toLowerCase())}function pt(t){return typeof t=="string"||t instanceof String}function j(t,e,n=[],s=null){for(let o of n){let f=s?`${s}${V(o)}`:o;Q(t,f)&&(e[o]=h(t,f))}}function H(t,e=window){return t.split(".").reduce((n,s)=>n[s],e)}function T(t){if(!t)return{};if(t.endsWith("()")){let n=H(t.replace("()",""));return n?n():{}}if(!t.includes(":"))return{default:t};let e=t;!t.startsWith("{")&&/[\w'"]\s*:\s*/.test(t)&&(e=`{${t.replace(/([^:\s{,]*)\s*:\s*('[^']*'|"[^"]*"|([\[].*?[\]])|[^,'"{\[]*)/g,(n,s,o)=>`"${s.replace(/['"]/g,"")}":${o.includes('"')?o:o.replace(/'/g,'"')}`)}}`);try{return P(JSON.parse(e))}catch(n){throw`Invalid config ${t} interpreted as ${e} with error ${n}`}}function P(t){for(let[e,n]of Object.entries(t))if(n&&typeof n=="object"){let s=n.__fn;pt(s)?t[e]=H(s):P(n)}return t}function dt(t=document){return t.documentElement}function w(){return dt().getAttribute("lang")||"en"}function q(){return"IntersectionObserver"in window}function A(t,e,n){let s=(f,l)=>{for(let a of f)a.type==="attributes"&&n(a.target,a.oldValue)},o=new MutationObserver(s);return o.observe(t,{attributes:!0,attributeOldValue:!0,attributeFilter:e}),()=>{o.disconnect(),o=null}}function g(t,e){return t.getAttribute(e)}function S(t,e){return t.dataset[e]===""||g(t,`data-${U(e)}`)===""||z(t.dataset[e])}function h(t,e){let n=t.dataset[e];return n==="false"?!1:n==="true"?!0:n}function Q(t,e){return t.dataset[e]!==void 0}function b(t,e){return t.dataset[e]}function Z(){return{years:3600*24*365,months:3600*24*30,weeks:3600*24*7,days:3600*24,hours:3600,minutes:60,seconds:1}}function O(t=null){return t?t instanceof Date?t:Number.isInteger(t)?new Date(t):new Date(I(k(t))):new Date}function k(t){let e=t;return gt(e)&&(e=`1970-01-01 ${e}`),mt(e,"1970-01-01 00:00:00")}function I(t){let e=t.split(" ");return`${e[0]}T${e[1]}Z`}function mt(t,e){let n=t.toString();for(;n.length<e.length;)n+=e[n.length];return n}function gt(t){return C(t)&&!F(t)}function C(t){return t.toString().includes(":")}function F(t){return t.toString().includes("-")||!C(t)}function M(t){return xt(t).toISOString().split(".")[0].replace("T"," ")}function xt(t){let e=O(t);return new Date(e.getTime()-e.getTimezoneOffset()*6e4)}function G(t){return M(t).split(" ")[0]}function _(t){return M(t).split(" ")[1]}function J(){return Intl.RelativeTimeFormat!==void 0}var K="querySelectorAll",X=(t,e=document,n=MutationObserver,s=["*"])=>{let o=(a,m,p,c,r,i)=>{for(let u of a)(i||K in u)&&(r?p.has(u)||(p.add(u),c.delete(u),t(u,r)):c.has(u)||(c.add(u),p.delete(u),t(u,r)),i||o(u[K](m),m,p,c,r,!0))},f=new n(a=>{if(s.length){let m=s.join(","),p=new Set,c=new Set;for(let{addedNodes:r,removedNodes:i}of a)o(i,m,p,c,!1,!1),o(r,m,p,c,!0,!1)}}),{observe:l}=f;return(f.observe=a=>l.call(f,a,{subtree:!0,childList:!0}))(e),f};var nt="querySelectorAll",{document:yt,Element:Y,MutationObserver:ht,Set:bt,WeakMap:Dt}=self,tt=t=>nt in t,{filter:et}=[],rt=t=>{let e=new Dt,n=r=>{for(let i=0,{length:u}=r;i<u;i++)e.delete(r[i])},s=()=>{let r=p.takeRecords();for(let i=0,{length:u}=r;i<u;i++)l(et.call(r[i].removedNodes,tt),!1),l(et.call(r[i].addedNodes,tt),!0)},o=r=>r.matches||r.webkitMatchesSelector||r.msMatchesSelector,f=(r,i)=>{let u;if(i)for(let d,v=o(r),y=0,{length:L}=a;y<L;y++)v.call(r,d=a[y])&&(e.has(r)||e.set(r,new bt),u=e.get(r),u.has(d)||(u.add(d),t.handle(r,i,d)));else e.has(r)&&(u=e.get(r),e.delete(r),u.forEach(d=>{t.handle(r,i,d)}))},l=(r,i=!0)=>{for(let u=0,{length:d}=r;u<d;u++)f(r[u],i)},{query:a}=t,m=t.root||yt,p=X(f,m,ht,a),{attachShadow:c}=Y.prototype;return c&&(Y.prototype.attachShadow=function(r){let i=c.call(this,r);return p.observe(i),i}),a.length&&l(m[nt](a)),{drop:n,flush:s,observer:p,parse:l}};function x(t,e){let n=t.get(e);n&&n(e)}var R=new WeakMap,E;q()&&(E=new IntersectionObserver((t,e)=>{let n=t.filter(s=>s.isIntersecting);for(let s of n){let o=s.target;e.unobserve(o),x(R,o)}}));function N(t,e){return E?(R.set(t,e),E.observe(t),()=>(R.delete(t),E.unobserve(t))):(e(t),()=>{})}var ot={},W=[],it=window.DEBUG||!1,{drop:st,flush:at,observer:ae,parse:B}=rt({query:W,document,async handle(t,e,n){let s=ot[n],o=s.initialized,f=s.lazyMap;if(it&&console.log(t,e,n),e){let l=()=>{o.has(t)||(s.callback(t),o.add(t))};S(t,"lazy")?f.set(t,N(t,l)):l()}else if(await Promise.resolve(),!t.isConnected){if(x(f,t),o.has(t)){let l=s.cleanup;l&&l(t)}o.delete(t)}}});function wt(t,e,n=null){let s=new WeakSet,o=new WeakMap;ot[t]={callback:e,cleanup:n,initialized:s,lazyMap:o},it&&console.log(`Register selector '${t}'`),W.includes(t)||(W.push(t),B($(t)))}var D=wt;function ut(t){if(!t.dataset.render)return;let e=T(b(t,"datetimeConfig")),n=g(t,"datetime"),s=b(t,"style"),o=b(t,"format"),f=S(t,"relative"),l=g(t,"lang")||w(),a=e;C(n)&&!a.timeStyle&&(a.timeStyle=s||"short"),F(n)&&!a.dateStyle&&(a.dateStyle=s||"short");let m=!1,p=!1;for(let i in t.dataset)["style","format","relative","render"].includes(i)||(["year","month","day"].includes(i)&&(m=!0),["hour","minute","second"].includes(i)&&(p=!0),a[i]=h(t,i));m&&a.dateStyle&&(a.dateStyle=void 0),p&&a.timeStyle&&(a.timeStyle=void 0);let c="",r=O(n);switch(o){case"iso":c=r.toISOString();break;case"utc":c=r.toUTCString();break;case"datetime":c=M(r);break;case"date":c=G(r);break;case"time":c=_(r);break;default:if(f){let i=Z(),u=(r.getTime()-Date.now())/1e3;for(let d in i)if(i[d]<Math.abs(u)){let v=u/i[d];if(J())c=new Intl.RelativeTimeFormat(l).format(Math.round(v),d);else{let y=Math.abs(Math.floor(v)),L=y===1?d.replace(/s$/,""):d;c=`${y} ${L}`}break}}else try{let i=Date.parse(I(k(n)));c=new Intl.DateTimeFormat(l,a).format(i)}catch(i){t.dataset.error=i}break}c.length>0&&(t.innerText=c)}var ct=new WeakMap;D("time[datetime]",t=>{g(t,"datetime")&&!t.innerText.trim()&&(t.dataset.render="true"),ut(t),ct.set(t,A(t,["datetime"],(n,s)=>{ut(n)}))},t=>{x(ct,t)});function ft(t){let e=T(b(t,"numberConfig")),n=g(t,"data-number");j(t,e,["currency","unit"]);let s=g(t,"lang")||w(),o=new Intl.NumberFormat().resolvedOptions();e.currency&&(o.currency=e.currency,o.style="currency"),e.unit&&(o.unit=e.unit,o.style="unit");for(let[a,m]of Object.entries(e))o[a]=m;for(let a in t.dataset)["value","currency","unit"].includes(a)||(o[a]=h(t,a));let f=new Intl.NumberFormat(s,o),l=Number(n);t.innerText=Number.isNaN(l)?"":f.format(l)}var lt=new WeakMap;D("span[data-number]",t=>{ft(t),lt.set(t,A(t,["data-number"],(e,n)=>{ft(e)}))},t=>{x(lt,t)});var ve={dynamicBehaviour:D,drop:st,parse:B,flush:at};export{ve as default};
/*! (c) Andrea Giammarchi - ISC */
/**
 * Modern now - formatters build
 * https://github.com/lekoala/modern-now
 * @license MIT
 */
